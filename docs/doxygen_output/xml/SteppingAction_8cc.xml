<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.10.0" xml:lang="en-US">
  <compounddef id="SteppingAction_8cc" kind="file" language="C++">
    <compoundname>SteppingAction.cc</compoundname>
    <includes refid="SteppingAction_8hh" local="yes">SteppingAction.hh</includes>
    <includes refid="EventAction_8hh" local="yes">EventAction.hh</includes>
    <includes refid="DetectorConstruction_8hh" local="yes">DetectorConstruction.hh</includes>
    <includes local="yes">G4Step.hh</includes>
    <includes local="yes">G4Event.hh</includes>
    <includes local="yes">G4RunManager.hh</includes>
    <includes local="yes">G4LogicalVolume.hh</includes>
    <includes local="yes">G4UnitsTable.hh</includes>
    <includes local="yes">G4SystemOfUnits.hh</includes>
    <includes local="yes">G4ParticleTable.hh</includes>
    <includes local="yes">G4Track.hh</includes>
    <includes local="yes">G4DynamicParticle.hh</includes>
    <includes local="yes">G4AutoLock.hh</includes>
    <includes local="yes">G4AnalysisManager.hh</includes>
    <includes local="yes">G4SDManager.hh</includes>
    <includes refid="GammaRayHelper_8hh" local="yes">GammaRayHelper.hh</includes>
    <includes local="no">vector</includes>
    <includes local="no">mutex</includes>
    <includes local="no">utility</includes>
    <incdepgraph>
      <node id="36">
        <label>Cluster.hh</label>
        <link refid="Cluster_8hh"/>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="37">
        <label>DetectorConstruction.hh</label>
        <link refid="DetectorConstruction_8hh"/>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="39">
        <label>DetectorConstructionMessenger.hh</label>
        <link refid="DetectorConstructionMessenger_8hh"/>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>EventAction.hh</label>
        <link refid="EventAction_8hh"/>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>ExtendedLivermoreComptonModel.hh</label>
        <link refid="ExtendedLivermoreComptonModel_8hh"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>GammaRayHelper.hh</label>
        <link refid="GammaRayHelper_8hh"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>Hit.hh</label>
        <link refid="Hit_8hh"/>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>Materials.hh</label>
        <link refid="Materials_8hh"/>
      </node>
      <node id="29">
        <label>SensitiveDetector.hh</label>
        <link refid="SensitiveDetector_8hh"/>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>SteppingAction.hh</label>
        <link refid="SteppingAction_8hh"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/SteppingAction.cc</label>
        <link refid="SteppingAction_8cc"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>G4Allocator.hh</label>
      </node>
      <node id="47">
        <label>G4AnalysisManager.hh</label>
      </node>
      <node id="19">
        <label>G4AutoLock.hh</label>
      </node>
      <node id="18">
        <label>G4DataVector.hh</label>
      </node>
      <node id="10">
        <label>G4DynamicParticle.hh</label>
      </node>
      <node id="43">
        <label>G4Event.hh</label>
      </node>
      <node id="7">
        <label>G4LivermoreComptonModel.hh</label>
      </node>
      <node id="12">
        <label>G4LivermorePhotoElectricModel.hh</label>
      </node>
      <node id="13">
        <label>G4LivermoreRayleighModel.hh</label>
      </node>
      <node id="45">
        <label>G4LogicalVolume.hh</label>
      </node>
      <node id="14">
        <label>G4Material.hh</label>
      </node>
      <node id="9">
        <label>G4MaterialCutsCouple.hh</label>
      </node>
      <node id="4">
        <label>G4ParticleTable.hh</label>
      </node>
      <node id="16">
        <label>G4PhysicalConstants.hh</label>
      </node>
      <node id="44">
        <label>G4RunManager.hh</label>
      </node>
      <node id="48">
        <label>G4SDManager.hh</label>
      </node>
      <node id="21">
        <label>G4Step.hh</label>
      </node>
      <node id="25">
        <label>G4String.hh</label>
      </node>
      <node id="17">
        <label>G4SystemOfUnits.hh</label>
      </node>
      <node id="26">
        <label>G4THitsCollection.hh</label>
      </node>
      <node id="15">
        <label>G4ThreeVector.hh</label>
      </node>
      <node id="20">
        <label>G4Track.hh</label>
      </node>
      <node id="35">
        <label>G4Types.hh</label>
      </node>
      <node id="41">
        <label>G4UIcmdWithADoubleAndUnit.hh</label>
      </node>
      <node id="40">
        <label>G4UImessenger.hh</label>
      </node>
      <node id="46">
        <label>G4UnitsTable.hh</label>
      </node>
      <node id="34">
        <label>G4UserEventAction.hh</label>
      </node>
      <node id="3">
        <label>G4UserSteppingAction.hh</label>
      </node>
      <node id="11">
        <label>G4VEMDataSet.hh</label>
      </node>
      <node id="23">
        <label>G4VHit.hh</label>
      </node>
      <node id="30">
        <label>G4VSensitiveDetector.hh</label>
      </node>
      <node id="38">
        <label>G4VUserDetectorConstruction.hh</label>
      </node>
      <node id="5">
        <label>globals.hh</label>
      </node>
      <node id="27">
        <label>map</label>
      </node>
      <node id="28">
        <label>mutex</label>
      </node>
      <node id="32">
        <label>utility</label>
      </node>
      <node id="31">
        <label>vector</label>
      </node>
    </incdepgraph>
    <innernamespace refid="namespaceG4FastSim">G4FastSim</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>********************************************************************</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>License<sp/>and<sp/>Disclaimer<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>The<sp/><sp/>Geant4<sp/>software<sp/><sp/>is<sp/><sp/>copyright<sp/>of<sp/>the<sp/>Copyright<sp/>Holders<sp/><sp/>of<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>the<sp/>Geant4<sp/>Collaboration.<sp/><sp/>It<sp/>is<sp/>provided<sp/><sp/>under<sp/><sp/>the<sp/>terms<sp/><sp/>and<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>conditions<sp/>of<sp/>the<sp/>Geant4<sp/>Software<sp/>License,<sp/><sp/>included<sp/>in<sp/>the<sp/>file<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>LICENSE<sp/>and<sp/>available<sp/>at<sp/><sp/>http://cern.ch/geant4/license<sp/>.<sp/><sp/>These<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>include<sp/>a<sp/>list<sp/>of<sp/>copyright<sp/>holders.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>Neither<sp/>the<sp/>authors<sp/>of<sp/>this<sp/>software<sp/>system,<sp/>nor<sp/>their<sp/>employing<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>institutes,nor<sp/>the<sp/>agencies<sp/>providing<sp/>financial<sp/>support<sp/>for<sp/>this<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>work<sp/><sp/>make<sp/><sp/>any<sp/>representation<sp/>or<sp/><sp/>warranty,<sp/>express<sp/>or<sp/>implied,<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>regarding<sp/><sp/>this<sp/><sp/>software<sp/>system<sp/>or<sp/>assume<sp/>any<sp/>liability<sp/>for<sp/>its<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>use.<sp/><sp/>Please<sp/>see<sp/>the<sp/>license<sp/>in<sp/>the<sp/>file<sp/><sp/>LICENSE<sp/><sp/>and<sp/>URL<sp/>above<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>for<sp/>the<sp/>full<sp/>disclaimer<sp/>and<sp/>the<sp/>limitation<sp/>of<sp/>liability.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>This<sp/><sp/>code<sp/><sp/>implementation<sp/>is<sp/>the<sp/>result<sp/>of<sp/><sp/>the<sp/><sp/>scientific<sp/>and<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>technical<sp/>work<sp/>of<sp/>the<sp/>GEANT4<sp/>collaboration.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>By<sp/>using,<sp/><sp/>copying,<sp/><sp/>modifying<sp/>or<sp/><sp/>distributing<sp/>the<sp/>software<sp/>(or<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>any<sp/>work<sp/>based<sp/><sp/>on<sp/>the<sp/>software)<sp/><sp/>you<sp/><sp/>agree<sp/><sp/>to<sp/>acknowledge<sp/>its<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>use<sp/><sp/>in<sp/><sp/>resulting<sp/><sp/>scientific<sp/><sp/>publications,<sp/><sp/>and<sp/>indicate<sp/>your<sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="comment">//<sp/>*<sp/>acceptance<sp/>of<sp/>all<sp/>terms<sp/>of<sp/>the<sp/>Geant4<sp/>Software<sp/>license.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="comment">//<sp/>********************************************************************</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="comment">//</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="SteppingAction_8hh" kindref="compound">SteppingAction.hh</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="EventAction_8hh" kindref="compound">EventAction.hh</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="DetectorConstruction_8hh" kindref="compound">DetectorConstruction.hh</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4Step.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4Event.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4RunManager.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4LogicalVolume.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4UnitsTable.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4SystemOfUnits.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4ParticleTable.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4Track.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4DynamicParticle.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4AutoLock.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4AnalysisManager.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;G4SDManager.hh&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="GammaRayHelper_8hh" kindref="compound">GammaRayHelper.hh</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vector&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;mutex&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;utility&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>G4Mutex<sp/>mutex<sp/>=<sp/>G4MUTEX_INITIALIZER;</highlight></codeline>
<codeline lineno="54"><highlight class="normal">}</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceG4FastSim" kindref="compound">G4FastSim</ref></highlight></codeline>
<codeline lineno="57"><highlight class="normal">{</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><ref refid="classSteppingAction_1a374afa1d769bcc5ba9d771cb83332a24" kindref="member">SteppingAction::SteppingAction</ref>(<ref refid="classEventAction" kindref="compound">EventAction</ref>*<sp/>eventAction,<sp/><ref refid="classGammaRayHelper" kindref="compound">GammaRayHelper</ref>*<sp/>helper)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>:<sp/>G4UserSteppingAction(),</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fEventAction(eventAction),</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fScoringVolume(nullptr),</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>particleTable(G4ParticleTable::GetParticleTable()),</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fGammaRayHelper(helper),<sp/></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fHitsCollectionInitialized(false){</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>hits<sp/>collection<sp/>is<sp/>not<sp/>yet<sp/>initialized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/>fHitsCollectionInitialized<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal">}</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><ref refid="classSteppingAction_1ace65491c5f93bdf39d14914767f896bf" kindref="member">SteppingAction::~SteppingAction</ref>()</highlight></codeline>
<codeline lineno="75"><highlight class="normal">{}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</highlight></codeline>
<codeline lineno="87"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classSteppingAction_1a4c685bf7180779d18c143c6ad1cce3fb" kindref="member">SteppingAction::UserSteppingAction</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>G4Step*<sp/>step)</highlight></codeline>
<codeline lineno="88"><highlight class="normal">{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>the<sp/>event<sp/>is<sp/>a<sp/>fast<sp/>simulation<sp/>event</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fEventAction-&gt;<ref refid="classEventAction_1aadb449a0f7a833b44e0136055950c37c" kindref="member">IsFastSimulation</ref>())<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>analyze<sp/>standard<sp/>step</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>AnalyzeStandardStep(step);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=<sp/>2){</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;</highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction&quot;</highlight><highlight class="normal">&lt;&lt;G4endl;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>volume<sp/>of<sp/>the<sp/>current<sp/>step</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/>G4LogicalVolume*<sp/>volume_pre<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume();</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/>G4String<sp/>particleName<sp/>=<sp/>step-&gt;GetTrack()-&gt;GetParticleDefinition()-&gt;GetParticleName();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>the<sp/>particle<sp/>is<sp/>a<sp/>geantino</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(particleName<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;geantino&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>kill<sp/>track<sp/>if<sp/>it<sp/>is<sp/>in<sp/>the<sp/>big<sp/>bad<sp/>world.....</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(volume_pre-&gt;GetName()<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;World&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>step-&gt;GetTrack()-&gt;SetTrackStatus(fStopAndKill);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=<sp/>2)<sp/><ref refid="classSteppingAction_1a0c02224c420b2e569e0fd73a15f27857" kindref="member">Print</ref>(step);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>(1)<sp/>we<sp/>are<sp/>inside<sp/>the<sp/>fiducial<sp/>volume<sp/>and<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>(2)<sp/>we<sp/>have<sp/>not<sp/>reached<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>scatters<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>===========&gt;<sp/>go<sp/>scatter<sp/>dude!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>G4int<sp/>number_of_scatters<sp/>=<sp/>fEventAction-&gt;<ref refid="classEventAction_1a162c883989911ba148346423d4a9bdd0" kindref="member">GetNumberOfScatters</ref>();</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>(volume_pre-&gt;GetName()<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;LXeFiducial&quot;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(number_of_scatters<sp/>&lt;<sp/>fEventAction-&gt;GetNumberOfScattersMax()))<sp/>{</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>*<sp/>Generate<sp/>an<sp/>interaction<sp/>somewhere<sp/>in<sp/>the<sp/>LXeFiducial<sp/>volume</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>result<sp/>=<sp/>fGammaRayHelper-&gt;<ref refid="classGammaRayHelper_1a749f2c6ac264a6065ca97de71443e9f0" kindref="member">GenerateInteractionPoint</ref>(step);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>G4ThreeVector<sp/>interactionPoint<sp/>=<sp/>result.first;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>the<sp/>weight<sp/>of<sp/>the<sp/>event<sp/>and<sp/>add<sp/>it<sp/>to<sp/>teh<sp/>event<sp/>sum<sp/>of<sp/>logs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1acefd80fbd497f9ff3d16f8bae126a789" kindref="member">AddWeight</ref>(std::log(result.second));</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=<sp/>2){</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Interaction<sp/>point<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>interactionPoint/cm<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Interaction<sp/>point<sp/>weight<sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>result.second<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>*<sp/>scattering:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>-<sp/>if<sp/>the<sp/>maximum<sp/>allowed<sp/>energy<sp/>is<sp/>above<sp/>the<sp/>photo-peak,<sp/>generate<sp/>a<sp/>PE<sp/>or<sp/>Compton<sp/>scatter,<sp/>based<sp/>on<sp/>the<sp/>relative<sp/>cross<sp/>sections</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>-<sp/>if<sp/>the<sp/>maximum<sp/>allowed<sp/>energy<sp/>is<sp/>below<sp/>the<sp/>photo-peak<sp/>-&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i)<sp/>ignore<sp/>PE<sp/>effect<sp/>and<sp/>assign<sp/>a<sp/>weight.<sp/>Then<sp/>just<sp/>do<sp/>Compton<sp/>scatter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ii)<sp/>calculate<sp/>the<sp/>maximum<sp/>scattering<sp/>angle<sp/>possible<sp/>and<sp/>generate<sp/>a<sp/>Compton<sp/>scatter.<sp/>Calculate<sp/>the<sp/>event<sp/>weight<sp/>based<sp/>on<sp/>the<sp/>non-sampled<sp/>scattering<sp/>angles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>G4double<sp/>weight<sp/>=<sp/>DoScatter(step,<sp/>interactionPoint);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1acefd80fbd497f9ff3d16f8bae126a789" kindref="member">AddWeight</ref>(std::log(weight));</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=<sp/>2){</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Scatter<sp/>weight<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>weight<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>the<sp/>number<sp/>of<sp/>scatters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1a820c16a2f7cc5d0c0880f73595cddea1" kindref="member">SetNumberOfScatters</ref>(number_of_scatters<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>Update<sp/>the<sp/>event<sp/>weight<sp/>based<sp/>on<sp/>the<sp/>traversed<sp/>material.<sp/>Once<sp/>the<sp/>geantino<sp/>leaves<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>active<sp/>vlume<sp/>of<sp/>the<sp/>TPC<sp/>the<sp/>track<sp/>will<sp/>be<sp/>killed<sp/>and<sp/>no<sp/>further<sp/>weights<sp/>need<sp/>to<sp/>be<sp/>calculated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>NOTE:<sp/>at<sp/>a<sp/>later<sp/>stage<sp/>we<sp/>could<sp/>generate<sp/>a<sp/>gamma<sp/>ray<sp/>with<sp/>the<sp/>appropriate<sp/>energy<sp/>at<sp/>the<sp/>boundary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>of<sp/>the<sp/>active<sp/>volume.<sp/>This<sp/>can<sp/>facilitate<sp/>generation<sp/>of<sp/>events<sp/>that<sp/>bounce<sp/>back<sp/>into<sp/>the<sp/>fiducial<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>volume</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>the<sp/>particle<sp/>is<sp/>a<sp/>geantino</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(particleName<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;geantino&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>attenuation<sp/>length<sp/>of<sp/>the<sp/>material<sp/>for<sp/>the<sp/>gamma<sp/>ray<sp/>at<sp/>the<sp/>current<sp/>energy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4double<sp/>attenuation_length<sp/>=<sp/>fGammaRayHelper-&gt;<ref refid="classGammaRayHelper_1aac1da704b4d19dc2aef4546db557cce9" kindref="member">GetAttenuationLength</ref>(step-&gt;GetPreStepPoint()-&gt;GetKineticEnergy(),<sp/></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>volume_pre-&gt;GetMaterial());</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4double<sp/>weight<sp/>=<sp/>std::exp(-step-&gt;GetStepLength()<sp/>/<sp/>attenuation_length);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel&gt;=2){</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Transport<sp/>material<sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>volume_pre-&gt;GetMaterial()-&gt;GetName()<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Attenuation<sp/>length<sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>attenuation_length<sp/>/<sp/>cm<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::UserSteppingAction<sp/><sp/><sp/>Transport<sp/>weight<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>weight<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1acefd80fbd497f9ff3d16f8bae126a789" kindref="member">AddWeight</ref>(std::log(weight));</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>next<sp/>volume<sp/>is<sp/>the<sp/>InnerCryostat<sp/>and<sp/>the<sp/>geantino<sp/>has<sp/>undergone<sp/>one<sp/>or<sp/>multiple<sp/>scatters,<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>we<sp/>want<sp/>to<sp/>kill<sp/>the<sp/>track</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4String<sp/>nextVolume<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume()-&gt;GetName();</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((nextVolume<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;InnerCryostat&quot;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>(number_of_scatters<sp/>&gt;<sp/>0)){</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step-&gt;GetTrack()-&gt;SetTrackStatus(fStopAndKill);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="comment">//<sp/>end<sp/>of<sp/>if:<sp/>geantino</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="comment">//<sp/>end<sp/>of<sp/>if:<sp/>in<sp/>Fiducial<sp/>volume<sp/>&amp;<sp/>number<sp/>of<sp/>scatters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal">}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight><highlight class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</highlight></codeline>
<codeline lineno="189"><highlight class="normal">G4double<sp/>SteppingAction::DoScatter(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>G4Step*<sp/>step,<sp/>G4ThreeVector<sp/>x0){</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/>G4AnalysisManager*<sp/>analysisManager<sp/>=<sp/>G4AnalysisManager::Instance();</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>energy<sp/>of<sp/>the<sp/>particle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/>G4double<sp/>energy<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetKineticEnergy();</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>G4double<sp/>energyDeposit<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/>G4double<sp/>weight<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>volume<sp/>of<sp/>the<sp/>current<sp/>step</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/>G4LogicalVolume*<sp/>volume_pre<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume();</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/>G4Material*<sp/>material<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>volume_pre-&gt;GetMaterial();</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>G4double<sp/>photoelectricCrossSection<sp/>=<sp/>fGammaRayHelper-&gt;<ref refid="classGammaRayHelper_1a904bd1187ecd382072b9e98ac5051646" kindref="member">GetPhotoelectricCrossSection</ref>(energy,<sp/>material);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/>G4double<sp/>comptonCrossSection<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>fGammaRayHelper-&gt;<ref refid="classGammaRayHelper_1a9210941982409cb5cc915759d7a0472a" kindref="member">GetComptonCrossSection</ref>(energy,<sp/>material);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/>G4double<sp/>ratio<sp/>=<sp/>comptonCrossSection<sp/>/<sp/>(photoelectricCrossSection<sp/>+<sp/>comptonCrossSection);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/>G4double<sp/>maxEnergy<sp/>=<sp/>fEventAction-&gt;<ref refid="classEventAction_1ade7a5b71891eaabe7e89a9016cb94006" kindref="member">GetAvailableEnergy</ref>();</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/>G4double<sp/>rand<sp/>=<sp/>G4UniformRand();</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/>G4Track*<sp/>track<sp/>=<sp/>step-&gt;GetTrack();</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/>G4String<sp/>process<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>(rand<sp/>&gt;<sp/>ratio)<sp/>&amp;&amp;<sp/>(energy<sp/>&lt;<sp/>maxEnergy)<sp/>){</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>process<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;phot&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>generate<sp/>a<sp/>PE<sp/>scatter:<sp/>we<sp/>make<sp/>an<sp/>energy<sp/>deposit<sp/>with<sp/>the<sp/>full<sp/>energyand<sp/>kill<sp/>the<sp/>track</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>energyDeposit<sp/>=<sp/>energy;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>process<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;compt&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>take<sp/>into<sp/>account<sp/>that<sp/>we<sp/>ignored<sp/>the<sp/>PE<sp/>effect<sp/>and<sp/>assign<sp/>a<sp/>weight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>generate<sp/>a<sp/>Compton<sp/>scatter<sp/>and<sp/>update<sp/>the<sp/>energy<sp/>deposit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>InteractionData<sp/>compton<sp/>=<sp/>fGammaRayHelper-&gt;<ref refid="classGammaRayHelper_1a5f490056674be18ba926a76bf683a521" kindref="member">DoComptonScatter</ref>(step,<sp/>x0,<sp/>maxEnergy);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/>energyDeposit<sp/>=<sp/>compton.energyDeposited;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>analysisManager-&gt;FillH1(0,<sp/>compton.cosTheta);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>take<sp/>into<sp/>account<sp/>the<sp/>Compton<sp/>scatter<sp/>weight,<sp/>only<sp/>if<sp/>the<sp/>maximum<sp/>allowed<sp/>energy<sp/>deposit<sp/>is<sp/>somewhere<sp/>in<sp/>the<sp/>Compton<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(energy<sp/>&gt;<sp/>maxEnergy)<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>weight<sp/>*=<sp/>ratio;<sp/></highlight><highlight class="comment">//<sp/>take<sp/>into<sp/>account<sp/>ignored<sp/>PE<sp/>effect</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>weight<sp/>*=<sp/>compton.weight;<sp/></highlight><highlight class="comment">//<sp/>take<sp/>into<sp/>account<sp/>the<sp/>Compton<sp/>scatter<sp/>weight,<sp/>only<sp/>if<sp/>the<sp/>maximum<sp/>allowed<sp/>energy<sp/>deposit<sp/>is<sp/>somewhere<sp/>in<sp/>the<sp/>Compton<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>a<sp/>secondary<sp/>track</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>G4ParticleTable*<sp/>particleTable<sp/>=<sp/>G4ParticleTable::GetParticleTable();</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>G4ParticleDefinition*<sp/>particleDefinition<sp/>=<sp/>particleTable-&gt;FindParticle(</highlight><highlight class="stringliteral">&quot;geantino&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>dynamic<sp/>particle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>particle<sp/>is<sp/>again<sp/>a<sp/>geantino<sp/>and<sp/>it<sp/>can<sp/>be<sp/>used<sp/>to<sp/>further<sp/>track</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>direction<sp/>of<sp/>the<sp/>particle<sp/>is<sp/>the<sp/>direction<sp/>after<sp/>the<sp/>Compton<sp/>scatter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>energy<sp/>of<sp/>the<sp/>particle<sp/>is<sp/>the<sp/>energy<sp/>after<sp/>the<sp/>Compton<sp/>scatter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>G4DynamicParticle*<sp/>dynamicParticle<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>G4DynamicParticle(particleDefinition,<sp/>compton.dir,<sp/>compton.energy);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>the<sp/>new<sp/>track</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>use<sp/>the<sp/>newly<sp/>created<sp/>dynamic<sp/>particle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>start<sp/>the<sp/>track<sp/>at<sp/>the<sp/>position<sp/>of<sp/>the<sp/>Compton<sp/>scatter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>G4Track*<sp/>newTrack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>G4Track(dynamicParticle,<sp/>0.0,<sp/>x0);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>additional<sp/>properties<sp/>of<sp/>the<sp/>new<sp/>track:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>inheritance<sp/>of<sp/>the<sp/>track<sp/>ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>the<sp/>track<sp/>is<sp/>good<sp/>for<sp/>tracking</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>newTrack-&gt;SetParentID(track-&gt;GetParentID());</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>newTrack-&gt;SetGoodForTrackingFlag(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>new<sp/>track<sp/>to<sp/>collection<sp/>of<sp/>secondaries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>G4TrackVector*<sp/>secondaries<sp/>=<sp/></highlight><highlight class="keyword">const_cast&lt;</highlight><highlight class="normal">G4TrackVector*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(step-&gt;GetSecondary());</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>secondaries-&gt;push_back(newTrack);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>the<sp/>available<sp/>energy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1ab28b59f1baa9fc2362717d03e650c73d" kindref="member">ReduceAvailableEnergy</ref>(energyDeposit);<sp/><sp/></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>kill<sp/>the<sp/>original<sp/>track.<sp/>the<sp/>new<sp/>track<sp/>will<sp/>be<sp/>tracked<sp/>further</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/>track-&gt;SetTrackStatus(fStopAndKill);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>a<sp/>new<sp/>hit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/>Hit*<sp/>newHit<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Hit();</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/>newHit-&gt;energyDeposit<sp/>=<sp/>energyDeposit;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/>newHit-&gt;position<sp/>=<sp/>x0;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/>newHit-&gt;time<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetGlobalTime();</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>newHit-&gt;trackID<sp/>=<sp/>step-&gt;GetTrack()-&gt;GetTrackID();</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/>newHit-&gt;parentID<sp/>=<sp/>step-&gt;GetTrack()-&gt;GetParentID();</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/>newHit-&gt;particleType<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;manual&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/>newHit-&gt;processType<sp/>=<sp/>process;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>hit<sp/>to<sp/>the<sp/>collection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/>AddHitToCollection(newHit,<sp/></highlight><highlight class="stringliteral">&quot;LXeFiducialCollection&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>weight;</highlight></codeline>
<codeline lineno="282"><highlight class="normal">}</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight><highlight class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classSteppingAction_1a0c02224c420b2e569e0fd73a15f27857" kindref="member">SteppingAction::Print</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>G4Step*<sp/>step)<sp/>{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/>G4Track*<sp/>track<sp/>=<sp/>step-&gt;GetTrack();</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/>G4LogicalVolume*<sp/>volume_pre<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume();</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/>G4String<sp/>processType<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetProcessDefinedStep()-&gt;GetProcessName();</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>Verbose<sp/>level<sp/>&gt;=2<sp/>print<sp/>this<sp/>information</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;SteppingAction::Print<sp/>track<sp/>ID<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>track-&gt;GetTrackID()<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>track<sp/>parent<sp/>ID<sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>track-&gt;GetParentID()<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle<sp/>name<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>track-&gt;GetParticleDefinition()-&gt;GetParticleName()<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>energy<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>track-&gt;GetKineticEnergy()<sp/>/<sp/>keV<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>keV&quot;</highlight><highlight class="normal">&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>volume_pre<sp/>name<sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>volume_pre-&gt;GetName()<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>volume_pre<sp/>position<sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>step-&gt;GetPreStepPoint()-&gt;GetPosition()/cm<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>cm&quot;</highlight><highlight class="normal">&lt;&lt;G4endl;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>volume_post<sp/>position<sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>step-&gt;GetPostStepPoint()-&gt;GetPosition()/cm<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>cm&quot;</highlight><highlight class="normal">&lt;&lt;G4endl;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>process<sp/>type<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>processType<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="307"><highlight class="normal">}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight><highlight class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>SteppingAction::AddHitToCollection(Hit*<sp/>newHit,<sp/>G4String<sp/>collectionName){</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fHitsCollectionInitialized)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=2)<sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Initializing<sp/>hits<sp/>collections&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4SDManager*<sp/>SDman<sp/>=<sp/>G4SDManager::GetSDMpointer();</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>//<sp/>fHitsCollectionIDs[&quot;LXeCollection&quot;]<sp/>=<sp/>SDman-&gt;GetCollectionID(&quot;LXeCollection&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fHitsCollectionIDs[</highlight><highlight class="stringliteral">&quot;LXeFiducialCollection&quot;</highlight><highlight class="normal">]<sp/>=<sp/>SDman-&gt;GetCollectionID(</highlight><highlight class="stringliteral">&quot;LXeFiducialCollection&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(verbosityLevel<sp/>&gt;=2){</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>//<sp/>G4cout<sp/>&lt;&lt;<sp/>&quot;Hits<sp/>collection<sp/>ID<sp/>for<sp/>LXeCollection:<sp/>&quot;<sp/>&lt;&lt;<sp/>fHitsCollectionIDs[&quot;LXeCollection&quot;]<sp/>&lt;&lt;<sp/>G4endl;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Hits<sp/>collection<sp/>ID<sp/>for<sp/>LXeFiducialCollection:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>fHitsCollectionIDs[</highlight><highlight class="stringliteral">&quot;LXeFiducialCollection&quot;</highlight><highlight class="normal">]<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>more<sp/>collections<sp/>here<sp/>if<sp/>needed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fHitsCollectionInitialized<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fHitsCollectionIDs.find(collectionName)<sp/>==<sp/>fHitsCollectionIDs.end())<sp/>{</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>Hits<sp/>collection<sp/>ID<sp/>not<sp/>found<sp/>for<sp/>collection<sp/>name:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>collectionName<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>G4int<sp/>hcID<sp/>=<sp/>fHitsCollectionIDs[collectionName];</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hcID<sp/>==<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>Hits<sp/>collection<sp/>ID<sp/>is<sp/>-1<sp/>for<sp/>collection<sp/>name:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>collectionName<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>G4Event*<sp/>evt<sp/>=<sp/>G4RunManager::GetRunManager()-&gt;GetCurrentEvent();</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>G4HCofThisEvent*<sp/>HCE<sp/>=<sp/>evt-&gt;GetHCofThisEvent();</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(HCE)<sp/>{</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fHitsCollections[collectionName]<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal">G4THitsCollection&lt;Hit&gt;*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(HCE-&gt;GetHC(hcID));</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fHitsCollections[collectionName]<sp/>==<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>G4cerr<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>Hits<sp/>collection<sp/>not<sp/>found<sp/>for<sp/>collection<sp/>name:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>collectionName<sp/>&lt;&lt;<sp/>G4endl;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>the<sp/>hit<sp/>to<sp/>the<sp/>collection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>fHitsCollections[collectionName]-&gt;insert(newHit);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>end<sp/>of<sp/>AddHitToCollection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>SteppingAction::AnalyzeStandardStep(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>G4Step*<sp/>step){</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>identify<sp/>a<sp/>gamma<sp/>ray<sp/>with<sp/>a<sp/>compton<sp/>scatter<sp/>outside<sp/>the<sp/>primary<sp/>particle<sp/>outside<sp/>the<sp/>xenon.......</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/>G4int<sp/>trackID<sp/>=<sp/>step-&gt;GetTrack()-&gt;GetTrackID();</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(verbosityLevel<sp/>&gt;=<sp/>2)<sp/><ref refid="classSteppingAction_1a0c02224c420b2e569e0fd73a15f27857" kindref="member">Print</ref>(step);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>the<sp/>primary<sp/>gamma<sp/>ray....</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(trackID<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/>G4String<sp/>processType<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetProcessDefinedStep()-&gt;GetProcessName();</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>G4String<sp/>volume_name<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume()-&gt;GetName();</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>particle<sp/>is<sp/>inside<sp/>the<sp/>xenon<sp/>volume</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((volume_name<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;LXeFiducial&quot;</highlight><highlight class="normal">)<sp/>||<sp/>(volume_name<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;LXe&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>particle<sp/>saw<sp/>liquid<sp/>xenon</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1a735b3d728f508a8106995b4dab6ea08d" kindref="member">SetHasBeenInXenon</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>G4String<sp/>volume_post<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume()-&gt;GetName();</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>this<sp/>gamma<sp/>leaves<sp/>the<sp/>xenon<sp/>volume.....<sp/>just<sp/>kill<sp/>it<sp/>to<sp/>make<sp/>sure<sp/>it<sp/>never<sp/>comes<sp/>back.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(volume_post<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;InnerCryostat&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step-&gt;GetTrack()-&gt;SetTrackStatus(fStopAndKill);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>after<sp/>checking<sp/>if<sp/>the<sp/>particle<sp/>is/has<sp/>been<sp/>inside<sp/>the<sp/>xenon<sp/>volume,<sp/>check<sp/>if<sp/>the<sp/>track<sp/>ID<sp/>is<sp/>1,<sp/>the<sp/>process<sp/>type<sp/>is<sp/>&quot;compt&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>((processType<sp/>==<sp/>&quot;compt&quot;)<sp/>&amp;&amp;<sp/>(!fEventAction-&gt;HasBeenInXenon()))<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((processType<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;compt&quot;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>((volume_name<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;LXeFiducial&quot;</highlight><highlight class="normal">)<sp/>&amp;&amp;<sp/>(volume_name<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;LXe&quot;</highlight><highlight class="normal">)))<sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fEventAction-&gt;<ref refid="classEventAction_1a405cc1d9e62dd3ba5209f1c8933536db" kindref="member">SetEventType</ref>(SCATTERED_GAMMA);</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>((processType<sp/>==<sp/>&quot;compt&quot;)<sp/>||<sp/>processType<sp/>==<sp/>&quot;phot&quot;)<sp/>&amp;&amp;<sp/>(fEventAction-&gt;HasBeenInXenon())<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>fEventAction-&gt;SetEventType(DIRECT_GAMMA);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//G4String<sp/>vol0<sp/>=<sp/>step-&gt;GetPreStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume()-&gt;GetName();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//G4String<sp/>vol1<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetTouchableHandle()-&gt;GetVolume()-&gt;GetLogicalVolume()-&gt;GetName();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//G4String<sp/>process<sp/>=<sp/>step-&gt;GetPostStepPoint()-&gt;GetProcessDefinedStep()-&gt;GetProcessName();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//G4String<sp/>particleName<sp/>=<sp/>step-&gt;GetTrack()-&gt;GetParticleDefinition()-&gt;GetParticleName();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//if<sp/>(<sp/>(<sp/>trackID<sp/>!=1<sp/>)<sp/>&amp;&amp;<sp/>(particleName<sp/>==<sp/>&quot;gamma&quot;)<sp/>&amp;&amp;<sp/>(vol0<sp/>==<sp/>&quot;LXeFiducial&quot;)<sp/>&amp;&amp;<sp/>(vol1<sp/>!=<sp/>&quot;LXeFiducial&quot;)<sp/>){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>G4cout<sp/>&lt;&lt;<sp/>&quot;SteppingAction::AnalyzeStandardStep<sp/><sp/><sp/>Secondary<sp/>Compton<sp/>scatter<sp/>outside<sp/>LXeFiducial<sp/>volume&quot;<sp/>&lt;&lt;<sp/>G4endl;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal">}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>G4FastSim</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/SteppingAction.cc"/>
  </compounddef>
</doxygen>
